"use strict";var _extends=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},_createClass=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}!function(t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("Griddie",n):t.Griddie=n()}(this,function(){navigator.userAgent.toLowerCase();var t=["WebKit","Moz","O","Ms",""],n=function(){for(var n=0;n<t.length;n++)if(t[n]+"MutationObserver"in window)return window[t[n]+"MutationObserver"];return!1}(),e=(function(){var t=document.createElement("div"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};for(var e in n)if(void 0!==t.style[e])return n[e]}(),function(t,n){return n+[].concat(_toConsumableArray(t.classList)).join("")+t.id+"Observer"}),i=function(t,n,i){var o=e(t,i+n);t[o]&&(t[o].disconnect(),delete t[o])},o=function(t,n,e){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];window["clear"+n](t[e]),delete t[e];var r=t.parentElement;o&&i(r,n,e)},r=function(t){return function(t,r,s,a,c){o(t,r,c),t[c]=window["set"+r](s,a);var l=t.parentElement,f=e(l,c+r);l[f]=new n(function(n){[].concat(_toConsumableArray(n[0].removedNodes)).some(function(n){return n===t})&&(o(t,r,c),i(l,r,c))}),l[f].observe(l,{childList:!0})}(t,"Timeout",arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"niteTimeout")};return function(){function t(n){var e=this;_classCallCheck(this,t),this._options={},this.options=n,this.layout(),window.addEventListener("resize",function(){return e.layout()})}return _createClass(t,[{key:"animate",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise(function(e,i){var o=function(){t.clear(),t.layout(0),t.store(1),t.transform(0),requestAnimationFrame(function(){t._options.element.style.transition="height "+t._options.transformTimingCSS+"s ease",[].concat(_toConsumableArray(t._options.items)).filter(function(t){return"none"!==t.style.display}).forEach(function(n){var e="transform "+t._options.transformTimingCSS+"s ease";t.options.animateWidthAndHeight&&(e+=", width "+t._options.transformTimingCSS+"s ease, height "+t._options.transformTimingCSS+"s ease"),n.style.transition=e}),requestAnimationFrame(function(){return t.transform(1)}),r(t._options.element,function(){t.clear(),e()},t.options.transformTiming,"transform")})};t.clear(),t.store(0),t.transform(0);var s,a=n();!(s=a)||"object"!==(void 0===s?"undefined":_typeof(s))&&"function"!=typeof s||"function"!=typeof s.then?o():a.then(function(){return o()})})}},{key:"filter",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",e=this._options.items.filter(function(t){return t.matches(n)}),i=this._options.items.filter(function(t){return!t.matches(n)}),o=e.filter(function(t){return"none"===t.style.display}),s=e.length!==o.length,a=function(){t._options.items.forEach(function(n){n.style.transition="opacity "+t._options.opacityTimingCSS+"s ease"})},c=function(){e.forEach(function(t){t.style.opacity=1}),i.forEach(function(t){t.style.opacity=0})},l=function(){t._options.items.forEach(function(t){t.style.transition="",t.style.opacity=""}),e.forEach(function(t){t.style.display=""}),i.forEach(function(t){t.style.display="none"})};this.animate(function(){return new Promise(function(n,e){var i=function(){t.store(0),t.transform(0),n()};a(),o.length&&o.forEach(function(t){t.style.opacity=0}),requestAnimationFrame(function(){o.length&&o.forEach(function(t){t.style.display=""}),o.length&&s?requestAnimationFrame(function(){return i()}):(!o.length||o.length&&!s)&&requestAnimationFrame(function(){c(),r(t._options.element,function(){l(),requestAnimationFrame(function(){return i()})},t.options.opacityTiming,"opacity")})})})}).then(function(){s&&(a(),requestAnimationFrame(function(){c(),clearTimeout(t._filterTimeout),t._filterTimeout=setTimeout(function(){return l()},t.options.opacityTiming)}))})}},{key:"destroy",value:function(){}},{key:"refresh",value:function(){}},{key:"layout",value:function(){if(this._options.masonry){var t=parseInt(window.getComputedStyle(this._options.element).getPropertyValue("grid-auto-rows")),n=parseInt(window.getComputedStyle(this._options.element).getPropertyValue("grid-row-gap"));this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(e){var i=Math.ceil((e.querySelector(".content").getBoundingClientRect().height+n)/(t+n));e.style.gridRowEnd="span "+i})}}},{key:"clear",value:function(){this._options.element.style.position="",this._options.element.style.width="",this._options.element.style.height="",this._options.element.style.transition="",this._options.items.forEach(function(t){t.style.transform="",t.style.transformOrigin="",t.style.position="",t.style.transition="",t.style.width="",t.style.height="",t.style.margin=""})}},{key:"store",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=document.body.scrollTop,i=document.body.scrollLeft,o=this._options.element.getBoundingClientRect();"rect"in this._options.element||(this._options.element.rect=[]),this._options.element.rect[n]={width:o.width,height:o.height,top:o.top+e,left:o.left+i},this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(o){"rect"in o||(o.rect=[]);var r=o.getBoundingClientRect();if(o.rect[n]={width:r.width,height:r.height,top:r.top+e-t._options.element.rect[n].top,left:r.left+i-t._options.element.rect[n].left,scaleX:1,scaleY:1},o.rect[n].top=o.rect[n].top>=0?o.rect[n].top:0,o.rect[n].left=o.rect[n].left>=0?o.rect[n].left:0,1===n){var s=o.rect[0].width/r.width,a=o.rect[0].height/r.height;s>0&&(o.rect[n].scaleX=1/s),a>0&&(o.rect[n].scaleY=1/a)}})}},{key:"transform",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._options.element.style.position="relative",this._options.element.style.width=this._options.element.rect[n].width+"px",this._options.element.style.height=this._options.element.rect[n].height+"px",this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(e){var i="translate3d("+e.rect[n].left+"px,"+e.rect[n].top+"px, 0px)";t.options.animateWidthAndHeight||(i+=" scale3d("+e.rect[n].scaleX+", "+e.rect[n].scaleY+", 1)"),(t.options.animateWidthAndHeight||0===n)&&(e.style.width=e.rect[n].width+"px",e.style.height=e.rect[n].height+"px"),e.style.margin=0,e.style.position="absolute",e.style.transformOrigin="0 0 0",e.style.transform=i})}},{key:"options",set:function(t){this._options=_extends({animateWidthAndHeight:!0,opacityTiming:300,transformTiming:300,masonry:!1},t),this._options.transformTimingCSS=this.options.transformTiming/1e3,this._options.opacityTimingCSS=this.options.opacityTiming/1e3,this._options.items=[].concat(_toConsumableArray(this._options.element.children))},get:function(){return this._options}}]),t}()});
//# sourceMappingURL=griddie.min.js.map
