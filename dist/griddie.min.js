"use strict";var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Griddie",e):t.Griddie=e()}(this,function(){navigator.userAgent.toLowerCase();var t=["WebKit","Moz","O","Ms",""],e=function(){for(var e=0;e<t.length;e++)if(t[e]+"MutationObserver"in window)return window[t[e]+"MutationObserver"];return!1}(),i=(function(){var t=document.createElement("div"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return e[i]}(),function(t,e){return e+[].concat(_toConsumableArray(t.classList)).join("")+t.id+"Observer"}),n=function(t,e,n){var o=i(t,n+e);t[o]&&(t[o].disconnect(),delete t[o])},o=function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];window["clear"+e](t[i]),delete t[i];var s=t.parentElement;o&&n(s,e,i)},s=function(t){return function(t,s,r,l,h){o(t,s,h),t[h]=window["set"+s](r,l);var c=t.parentElement,a=i(c,h+s);c[a]=new e(function(e){[].concat(_toConsumableArray(e[0].removedNodes)).some(function(e){return e===t})&&(o(t,s,h),n(c,s,h))}),c[a].observe(c,{childList:!0})}(t,"Timeout",arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"niteTimeout")},r=function(){function t(){_classCallCheck(this,t),this._window=window,this._html=document.documentElement,this._body=document.body,this._frame1=this._window,this._frame2=this._html||this._body,this._prefix1="inner",this._prefix2="offset",!this._prefix1+"Width"in this._frame1&&(this._prefix1="client",this._frame1=this._frame2),this._offsetWidth=0,this._offsetHeight=0,this._width=0,this._height=0,this._scrollTop=0,this._scrollLeft=0,this._lock=!1,this.calcAll()}return _createClass(t,[{key:"calcOffsetWidth",value:function(){return this._offsetWidth=this._body[this._prefix2+"Width"],this.offsetWidth}},{key:"calcOffsetHeight",value:function(){return this._offsetHeight=this._body[this._prefix2+"Height"],this.offsetHeight}},{key:"calcWidth",value:function(){return this._width=this._frame1[this._prefix1+"Width"],this.width}},{key:"calcHeight",value:function(){return this._height=this._frame1[this._prefix1+"Height"],this.height}},{key:"calcScrollTop",value:function(){return this._scrollTop=this._frame2.scrollTop||0,this.scrollTop}},{key:"calcScrollLeft",value:function(){return this._scrollLeft=this._frame2.scrollLeft||0,this.scrollLeft}},{key:"calcAll",value:function(){return this.calcOffsetWidth(),this.calcOffsetHeight(),this.calcWidth(),this.calcHeight(),this.calcScrollTop(),this.calcScrollLeft(),this.all}},{key:"offsetWidth",get:function(){return this._offsetWidth}},{key:"offsetHeight",get:function(){return this._offsetHeight}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"scrollTop",get:function(){return this._scrollTop}},{key:"scrollLeft",get:function(){return this._scrollLeft}},{key:"all",get:function(){return{offsetWidth:this.offsetWidth,offsetHeight:this.offsetHeight,width:this.width,height:this.height,scrollTop:this.scrollTop,scrollLeft:this.scrollLeft}}},{key:"lock",get:function(){return this._lock},set:function(t){if(this._lock=t,this._lock){this._body.style.top=-this.calcScrollTop()+"px",this._body.style.left=-this.calcScrollLeft()+"px";var e=this.calcOffsetWidth(),i=this.calcOffsetHeight();this._html.style.top="0px",this._html.style.left="0px",this._html.style.position="fixed",this._body.style.position="fixed",this._html.style.width="100%",this._body.style.width="100%";var n=this.calcOffsetWidth(),o=this.calcOffsetHeight();e=n-e,i=o-i,this._body.style.width=n-e+"px",this._body.style.height=o-i+"px"}else{var s=Math.abs(parseFloat(this._body.style.top)),r=Math.abs(parseFloat(this._body.style.left));this._html.style.position="",this._html.style.top="",this._html.style.left="",this._html.style.width="",this._body.style.position="",this._body.style.top="",this._body.style.left="",this._body.style.width="",this._window.scroll({top:s,left:r,behavior:"instant"})}}}]),t}();return function(){function t(e){var i=this;_classCallCheck(this,t),this._options={},this.options=e,this._viewport=new r,this.layout(),window.addEventListener("resize",function(){return i.layout()})}return _createClass(t,[{key:"animate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise(function(i,n){var o=function(){t.clear(),t.layout(0),t.store(1),t.transform(0),requestAnimationFrame(function(){t._options.element.style.transition="height "+t._options.transformTimingCSS+"s ease",[].concat(_toConsumableArray(t._options.items)).filter(function(t){return"none"!==t.style.display}).forEach(function(e){var i="transform "+t._options.transformTimingCSS+"s ease";t.options.scaleXY||(i+=", width "+t._options.transformTimingCSS+"s ease, height "+t._options.transformTimingCSS+"s ease"),e.style.transition=i}),requestAnimationFrame(function(){return t.transform(1)}),s(t._options.element,function(){t.clear(),i()},t.options.transformTiming,"transform")})};t.clear(),t.store(0),t.transform(0);var r,l=e();!(r=l)||"object"!==(void 0===r?"undefined":_typeof(r))&&"function"!=typeof r||"function"!=typeof r.then?o():l.then(function(){return o()})})}},{key:"filter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",i=this._options.items.filter(function(t){return t.matches(e)}),n=this._options.items.filter(function(t){return!t.matches(e)}),o=i.filter(function(t){return"none"===t.style.display}),r=i.length!==o.length,l=function(){t._options.items.forEach(function(e){e.style.transition="opacity "+t._options.opacityTimingCSS+"s ease"})},h=function(){i.forEach(function(t){t.style.opacity=1}),n.forEach(function(t){t.style.opacity=0})},c=function(){t._options.items.forEach(function(t){t.style.transition="",t.style.opacity=""}),i.forEach(function(t){t.style.display=""}),n.forEach(function(t){t.style.display="none"})};this.animate(function(){return new Promise(function(e,i){var n=function(){t.store(0),t.transform(0),e()};l(),o.length&&o.forEach(function(t){t.style.opacity=0}),requestAnimationFrame(function(){o.length&&o.forEach(function(t){t.style.display=""}),o.length&&r?requestAnimationFrame(function(){return n()}):(!o.length||o.length&&!r)&&requestAnimationFrame(function(){h(),s(t._options.element,function(){c(),requestAnimationFrame(function(){return n()})},t.options.opacityTiming,"opacity")})})})}).then(function(){r&&(l(),requestAnimationFrame(function(){h(),clearTimeout(t._filterTimeout),t._filterTimeout=setTimeout(function(){return c()},t.options.opacityTiming)}))})}},{key:"destroy",value:function(){}},{key:"refresh",value:function(){}},{key:"layout",value:function(){if(this._options.masonry){var t=parseInt(window.getComputedStyle(this._options.element).getPropertyValue("grid-auto-rows")),e=parseInt(window.getComputedStyle(this._options.element).getPropertyValue("grid-row-gap"));this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(i){var n=Math.ceil((i.querySelector(".content").getBoundingClientRect().height+e)/(t+e));i.style.gridRowEnd="span "+n})}}},{key:"clear",value:function(){this._options.element.style.position="",this._options.element.style.width="",this._options.element.style.height="",this._options.element.style.transition="",this._options.items.forEach(function(t){t.style.transform="",t.style.transformOrigin="",t.style.position="",t.style.transition="",t.style.width="",t.style.height="",t.style.margin=""})}},{key:"store",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._viewport.calcScrollTop(),this._viewport.calcScrollLeft();var i=this._options.element.getBoundingClientRect();"rect"in this._options.element||(this._options.element.rect=[]),this._options.element.rect[e]={width:i.width,height:i.height,top:i.top+this._viewport.scrollTop,left:i.left+this._viewport.scrollLeft},this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(i){"rect"in i||(i.rect=[]);var n=i.getBoundingClientRect();if(i.rect[e]={width:n.width,height:n.height,top:n.top+t._viewport.scrollTop-t._options.element.rect[e].top,left:n.left+t._viewport.scrollLeft-t._options.element.rect[e].left,scaleX:1,scaleY:1},i.rect[e].top=i.rect[e].top>=0?i.rect[e].top:0,i.rect[e].left=i.rect[e].left>=0?i.rect[e].left:0,1===e){var o=i.rect[0].width/n.width,s=i.rect[0].height/n.height;o>0&&(i.rect[e].scaleX=1/o),s>0&&(i.rect[e].scaleY=1/s)}})}},{key:"transform",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._options.element.style.position="relative",this._options.element.style.width=this._options.element.rect[e].width+"px",this._options.element.style.height=this._options.element.rect[e].height+"px",this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(i){var n="translate3d("+i.rect[e].left+"px,"+i.rect[e].top+"px, 0px)";t.options.scaleXY&&(n+=" scale3d("+i.rect[e].scaleX+", "+i.rect[e].scaleY+", 1)"),t.options.scaleXY&&0!==e||(i.style.width=i.rect[e].width+"px",i.style.height=i.rect[e].height+"px"),i.style.margin=0,i.style.position="absolute",i.style.transformOrigin="0 0 0",i.style.transform=n})}},{key:"options",set:function(t){this._options=_extends({scaleXY:!1,opacityTiming:300,transformTiming:300,masonry:!1},t),this._options.transformTimingCSS=this.options.transformTiming/1e3,this._options.opacityTimingCSS=this.options.opacityTiming/1e3,this._options.items=[].concat(_toConsumableArray(this._options.element.children))},get:function(){return this._options}}]),t}()});
//# sourceMappingURL=griddie.min.js.map
