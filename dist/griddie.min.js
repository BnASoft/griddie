"use strict";var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Griddie",e):t.Griddie=e()}(this,function(){return function(){function t(e){var n=this;_classCallCheck(this,t),this._options={},this._animationTimeout=null,this._filterTimeout=null,this.options=e,this.layout(),window.addEventListener("resize",function(){return n.layout()})}return _createClass(t,[{key:"animate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise(function(n,i){var o=function(){t.clear(),t.layout(0),t.store(1),t.transform(0),requestAnimationFrame(function(){t._options.element.style.transition="height "+t._options.transformTimingCSS+"s ease",[].concat(_toConsumableArray(t._options.items)).filter(function(t){return"none"!==t.style.display}).forEach(function(e){var n="transform "+t._options.transformTimingCSS+"s ease";t.options.animateWidthAndHeight&&(n+=", width "+t._options.transformTimingCSS+"s ease, height "+t._options.transformTimingCSS+"s ease"),e.style.transition=n}),requestAnimationFrame(function(){return t.transform(1)}),clearTimeout(t._animationTimeout),t._animationTimeout=setTimeout(function(){t.clear(),n()},t.options.transformTiming)})};t.clear(),t.store(0),t.transform(0);var r,s=e();!(r=s)||"object"!==(void 0===r?"undefined":_typeof(r))&&"function"!=typeof r||"function"!=typeof r.then?o():s.then(function(){return o()})})}},{key:"filter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",n=this._options.items.filter(function(t){return t.matches(e)}),i=this._options.items.filter(function(t){return!t.matches(e)}),o=n.filter(function(t){return"none"===t.style.display}),r=n.length!==o.length,s=function(){t._options.items.forEach(function(e){e.style.transition="opacity "+t._options.opacityTimingCSS+"s ease"})},a=function(){n.forEach(function(t){t.style.opacity=1}),i.forEach(function(t){t.style.opacity=0})},l=function(){t._options.items.forEach(function(t){t.style.transition="",t.style.opacity=""}),n.forEach(function(t){t.style.display=""}),i.forEach(function(t){t.style.display="none"})};this.animate(function(){return new Promise(function(e,n){var i=function(){t.store(0),t.transform(0),e()};s(),o.length&&o.forEach(function(t){t.style.opacity=0}),requestAnimationFrame(function(){o.length&&o.forEach(function(t){t.style.display=""}),o.length&&r?requestAnimationFrame(function(){return i()}):(!o.length||o.length&&!r)&&requestAnimationFrame(function(){a(),clearTimeout(t._filterTimeout),t._filterTimeout=setTimeout(function(){l(),requestAnimationFrame(function(){return i()})},t.options.opacityTiming)})})})}).then(function(){r&&(s(),requestAnimationFrame(function(){a(),clearTimeout(t._filterTimeout),t._filterTimeout=setTimeout(function(){return l()},t.options.opacityTiming)}))})}},{key:"destroy",value:function(){}},{key:"refresh",value:function(){}},{key:"layout",value:function(){if(this._options.masonry){var t=parseInt(window.getComputedStyle(this._options.element).getPropertyValue("grid-auto-rows")),e=parseInt(window.getComputedStyle(this._options.element).getPropertyValue("grid-row-gap"));this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(n){var i=Math.ceil((n.querySelector(".content").getBoundingClientRect().height+e)/(t+e));n.style.gridRowEnd="span "+i})}}},{key:"clear",value:function(){this._options.element.style.position="",this._options.element.style.width="",this._options.element.style.height="",this._options.element.style.transition="",this._options.items.forEach(function(t){t.style.transform="",t.style.transformOrigin="",t.style.position="",t.style.transition="",t.style.width="",t.style.height="",t.style.margin=""})}},{key:"store",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=document.body.scrollTop,i=document.body.scrollLeft,o=this._options.element.getBoundingClientRect();"rect"in this._options.element||(this._options.element.rect=[]),this._options.element.rect[e]={width:o.width,height:o.height,top:o.top+n,left:o.left+i},this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(o){"rect"in o||(o.rect=[]);var r=o.getBoundingClientRect();if(o.rect[e]={width:r.width,height:r.height,top:r.top+n-t._options.element.rect[e].top,left:r.left+i-t._options.element.rect[e].left,scaleX:1,scaleY:1},o.rect[e].top=o.rect[e].top>=0?o.rect[e].top:0,o.rect[e].left=o.rect[e].left>=0?o.rect[e].left:0,1===e){var s=o.rect[0].width/r.width,a=o.rect[0].height/r.height;s>0&&(o.rect[e].scaleX=1/s),a>0&&(o.rect[e].scaleY=1/a)}})}},{key:"transform",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._options.element.style.position="relative",this._options.element.style.width=this._options.element.rect[e].width+"px",this._options.element.style.height=this._options.element.rect[e].height+"px",this._options.items.filter(function(t){return"none"!==t.style.display}).forEach(function(n){var i="translate3d("+n.rect[e].left+"px,"+n.rect[e].top+"px, 0px)";t.options.animateWidthAndHeight||(i+=" scale3d("+n.rect[e].scaleX+", "+n.rect[e].scaleY+", 1)"),(t.options.animateWidthAndHeight||0===e)&&(n.style.width=n.rect[e].width+"px",n.style.height=n.rect[e].height+"px"),n.style.margin=0,n.style.position="absolute",n.style.transformOrigin="0 0 0",n.style.transform=i})}},{key:"options",set:function(t){this._options=_extends({animateWidthAndHeight:!0,opacityTiming:300,transformTiming:300,masonry:!1},t),this._options.transformTimingCSS=this.options.transformTiming/1e3,this._options.opacityTimingCSS=this.options.opacityTiming/1e3,this._options.items=[].concat(_toConsumableArray(this._options.element.children))},get:function(){return this._options}}]),t}()});
//# sourceMappingURL=griddie.min.js.map
