{"version":3,"sources":["griddie.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_typeof","Symbol","iterator","obj","constructor","_classCallCheck","instance","TypeError","_toConsumableArray","arr","Array","isArray","arr2","from","global","factory","exports","module","define","amd","Griddie","this","navigator","userAgent","toLowerCase","vendorsPrefixes","MutationObserver","window","getObserverId","el","document","createElement","transEndEventNames","WebkitTransition","MozTransition","OTransition","msTransition","transition","name","undefined","style","parent","prefix","concat","classList","join","id","disconnectObserver","mode","observerId","disconnect","clearElementTimer","element","autoDisconnectObserver","parentElement","attachTimeout","callback","time","e","removedNodes","some","observe","childList","setElementTimer","Viewport","_window","_html","documentElement","_body","body","_frame1","_frame2","_prefix1","_prefix2","_offsetWidth","_offsetHeight","_width","_height","_scrollTop","_scrollLeft","_lock","calcAll","value","offsetWidth","offsetHeight","width","height","scrollTop","scrollLeft","calcOffsetWidth","calcOffsetHeight","calcWidth","calcHeight","calcScrollTop","calcScrollLeft","all","get","set","bool","top","left","scrollBarWidth","scrollBarHeight","position","Math","abs","parseFloat","scroll","behavior","options","_this","_options","_viewport","layout","addEventListener","_this2","layoutChanges","Promise","resolve","reject","clear","store","transform","requestAnimationFrame","transformTimingCSS","items","filter","item","display","forEach","scaleXY","transformTiming","object","changes","then","_this3","_filter","matched","x","matches","unmatched","hiddenMatched","makeRoomBeforeFade","prepareFade","opacityTimingCSS","fade","opacity","clearFade","animate","onFadeEnd","opacityTiming","clearTimeout","_filterTimeout","setTimeout","masonry","rowHeight","parseInt","getComputedStyle","getPropertyValue","rowGap","rowSpan","ceil","querySelector","getBoundingClientRect","gridRowEnd","transformOrigin","margin","_this4","gridRect","rect","itemRect","scaleX","scaleY","_this5","children"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Griddie', factory) :\n    (global.Griddie = factory());\n}(this, (function () { 'use strict';\n\n    const isPromise = object => !!object && (typeof object === 'object' || typeof object === 'function') && typeof object.then === 'function';\n\n    const userAgent = navigator.userAgent.toLowerCase();\r\n\r\n    const vendorsPrefixes = ['WebKit', 'Moz', 'O', 'Ms', ''];\r\n\r\n    const MutationObserver = (() => {\r\n        for (let i = 0; i < vendorsPrefixes.length; i++) {\r\n            if (vendorsPrefixes[i] + 'MutationObserver' in window) {\r\n                return window[vendorsPrefixes[i] + 'MutationObserver'];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    })();\r\n\r\n    const transitionEndEventName = (() => {\r\n        const el = document.createElement('div');\r\n\r\n        const transEndEventNames = {\r\n            WebkitTransition: 'webkitTransitionEnd',\r\n            MozTransition: 'transitionend',\r\n            OTransition: 'oTransitionEnd otransitionend',\r\n            msTransition: 'MSTransitionEnd',\r\n            transition: 'transitionend'\r\n        };\r\n\r\n        for (let name in transEndEventNames) {\r\n            if (el.style[name] !== undefined) {\r\n                return transEndEventNames[name];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    })();\n\n    const getObserverId = (parent, prefix) => prefix + [...parent.classList].join('') + parent.id + 'Observer';\r\n\r\n    const disconnectObserver = (parent, mode, id) => {\r\n        const observerId = getObserverId(parent, id + mode);\r\n        if (parent[observerId]) {\r\n            parent[observerId].disconnect();\r\n            delete parent[observerId];\r\n        }\r\n    };\r\n\r\n    const setElementTimer = (element, mode, callback, time, id) => {\r\n        clearElementTimer(element, mode, id);\r\n        element[id] = window['set' + mode](callback, time);\r\n\r\n        const parent = element.parentElement;\r\n        const observerId = getObserverId(parent, id + mode);\r\n        parent[observerId] = new MutationObserver(e => {\r\n            if ([...e[0].removedNodes].some(el => el === element)) {\r\n                clearElementTimer(element, mode, id);\r\n                disconnectObserver(parent, mode, id);\r\n            }\r\n        });\r\n        parent[observerId].observe(parent, { childList: true });\r\n    };\r\n\r\n    const clearElementTimer = (element, mode, id, autoDisconnectObserver = false) => {\r\n        window['clear' + mode](element[id]);\r\n        delete element[id];\r\n\r\n        const parent = element.parentElement;\r\n        if (autoDisconnectObserver) {\r\n            disconnectObserver(parent, mode, id);\r\n        }\r\n    };\r\n\r\n    const attachTimeout = (element, callback = () => {}, time = 0, id = 'niteTimeout') => setElementTimer(element, 'Timeout', callback, time, id);\n\n    /**\r\n     * @param {string} prop\r\n     * @param {string} value\r\n     * @returns {boolean}\r\n     */\n\n    /**\r\n     *\r\n     */\r\n    class Viewport {\r\n        constructor() {\r\n            this._window = window;\r\n            this._html = document.documentElement;\r\n            this._body = document.body;\r\n\r\n            this._frame1 = this._window;\r\n            this._frame2 = this._html || this._body;\r\n            this._prefix1 = 'inner';\r\n            this._prefix2 = 'offset';\r\n            if (!this._prefix1 + 'Width' in this._frame1) {\r\n                this._prefix1 = 'client';\r\n                this._frame1 = this._frame2;\r\n            }\r\n\r\n            this._offsetWidth = 0;\r\n            this._offsetHeight = 0;\r\n            this._width = 0;\r\n            this._height = 0;\r\n            this._scrollTop = 0;\r\n            this._scrollLeft = 0;\r\n\r\n            this._lock = false;\r\n\r\n            this.calcAll();\r\n        }\r\n\r\n        get offsetWidth() {\r\n            return this._offsetWidth;\r\n        }\r\n        get offsetHeight() {\r\n            return this._offsetHeight;\r\n        }\r\n        get width() {\r\n            return this._width;\r\n        }\r\n        get height() {\r\n            return this._height;\r\n        }\r\n        get scrollTop() {\r\n            return this._scrollTop;\r\n        }\r\n        get scrollLeft() {\r\n            return this._scrollLeft;\r\n        }\r\n        get all() {\r\n            return {\r\n                offsetWidth: this.offsetWidth,\r\n                offsetHeight: this.offsetHeight,\r\n                width: this.width,\r\n                height: this.height,\r\n                scrollTop: this.scrollTop,\r\n                scrollLeft: this.scrollLeft\r\n            };\r\n        }\r\n\r\n        calcOffsetWidth() {\r\n            this._offsetWidth = this._body[this._prefix2 + 'Width'];\r\n            return this.offsetWidth;\r\n        }\r\n        calcOffsetHeight() {\r\n            this._offsetHeight = this._body[this._prefix2 + 'Height'];\r\n            return this.offsetHeight;\r\n        }\r\n        calcWidth() {\r\n            this._width = this._frame1[this._prefix1 + 'Width'];\r\n            return this.width;\r\n        }\r\n        calcHeight() {\r\n            this._height = this._frame1[this._prefix1 + 'Height'];\r\n            return this.height;\r\n        }\r\n        calcScrollTop() {\r\n            this._scrollTop = this._frame2.scrollTop || 0;\r\n            return this.scrollTop;\r\n        }\r\n        calcScrollLeft() {\r\n            this._scrollLeft = this._frame2.scrollLeft || 0;\r\n            return this.scrollLeft;\r\n        }\r\n        calcAll() {\r\n            this.calcOffsetWidth();\r\n            this.calcOffsetHeight();\r\n            this.calcWidth();\r\n            this.calcHeight();\r\n            this.calcScrollTop();\r\n            this.calcScrollLeft();\r\n            return this.all;\r\n        }\r\n\r\n        get lock() {\r\n            return this._lock;\r\n        }\r\n\r\n        set lock(bool) {\r\n            this._lock = bool;\r\n\r\n            if (this._lock) {\r\n                this._body.style.top = -this.calcScrollTop() + 'px';\r\n                this._body.style.left = -this.calcScrollLeft() + 'px';\r\n\r\n                let scrollBarWidth = this.calcOffsetWidth();\r\n                let scrollBarHeight = this.calcOffsetHeight();\r\n\r\n                this._html.style.top = '0px';\r\n                this._html.style.left = '0px';\r\n                this._html.style.position = 'fixed';\r\n                this._body.style.position = 'fixed';\r\n                this._html.style.width = '100%';\r\n                this._body.style.width = '100%';\r\n\r\n                let offsetWidth = this.calcOffsetWidth();\r\n                let offsetHeight = this.calcOffsetHeight();\r\n                scrollBarWidth = offsetWidth - scrollBarWidth;\r\n                scrollBarHeight = offsetHeight - scrollBarHeight;\r\n\r\n                this._body.style.width = offsetWidth - scrollBarWidth + 'px';\r\n                this._body.style.height = offsetHeight - scrollBarHeight + 'px';\r\n            } else {\r\n                let scrollTop = Math.abs(parseFloat(this._body.style.top));\r\n                let scrollLeft = Math.abs(parseFloat(this._body.style.left));\r\n\r\n                this._html.style.position = '';\r\n                this._html.style.top = '';\r\n                this._html.style.left = '';\r\n                this._html.style.width = '';\r\n                this._body.style.position = '';\r\n                this._body.style.top = '';\r\n                this._body.style.left = '';\r\n                this._body.style.width = '';\r\n\r\n                this._window.scroll({\r\n                    top: scrollTop,\r\n                    left: scrollLeft,\r\n                    behavior: 'instant'\r\n                });\r\n            }\r\n        }\r\n    }\n\n    class Griddie {\r\n        constructor(options) {\r\n            this._options = {};\r\n            this.options = options;\r\n            this._viewport = new Viewport();\r\n            this.layout();\r\n            window.addEventListener('resize', () => this.layout());\r\n        }\r\n\r\n        set options(options) {\r\n            this._options = {\r\n                ...{\r\n                    scaleXY: false, // TODO: single item exceptions ...\r\n                    opacityTiming: 300,\r\n                    transformTiming: 300,\r\n                    masonry: false\r\n                },\r\n                ...options\r\n            };\r\n            this._options.transformTimingCSS = this.options.transformTiming / 1000;\r\n            this._options.opacityTimingCSS = this.options.opacityTiming / 1000;\r\n            this._options.items = [...this._options.element.children];\r\n        }\r\n\r\n        get options() {\r\n            return this._options;\r\n        }\r\n\r\n        animate(layoutChanges = () => {}) {\r\n            const animation = new Promise((resolve, reject) => {\r\n                const callback = () => {\r\n                    this.clear();\r\n                    this.layout(0);\r\n                    this.store(1);\r\n                    this.transform(0);\r\n\r\n                    requestAnimationFrame(() => {\r\n                        this._options.element.style.transition = 'height ' + this._options.transformTimingCSS + 's ease';\r\n                        [...this._options.items].filter(item => item.style.display !== 'none').forEach(item => {\r\n                            let transition = 'transform ' + this._options.transformTimingCSS + 's ease';\r\n                            if (!this.options.scaleXY) {\r\n                                transition += ', width ' + this._options.transformTimingCSS + 's ease, height ' + this._options.transformTimingCSS + 's ease';\r\n                            }\r\n\r\n                            item.style.transition = transition;\r\n                        });\r\n\r\n                        requestAnimationFrame(() => this.transform(1));\r\n\r\n                        attachTimeout(\r\n                            this._options.element,\r\n                            () => {\r\n                                this.clear();\r\n                                resolve();\r\n                            },\r\n                            this.options.transformTiming,\r\n                            'transform'\r\n                        );\r\n                    });\r\n                };\r\n\r\n                this.clear();\r\n                this.store(0);\r\n                this.transform(0);\r\n\r\n                const changes = layoutChanges();\r\n\r\n                if (isPromise(changes)) {\r\n                    changes.then(() => callback());\r\n                } else {\r\n                    callback();\r\n                }\r\n            });\r\n\r\n            return animation;\r\n        }\r\n\r\n        filter(filter = '*') {\r\n            const matched = this._options.items.filter(x => x.matches(filter));\r\n            const unmatched = this._options.items.filter(x => !x.matches(filter));\r\n            const hiddenMatched = matched.filter(x => x.style.display === 'none');\r\n            const makeRoomBeforeFade = matched.length !== hiddenMatched.length;\r\n            const prepareFade = () => {\r\n                this._options.items.forEach(item => {\r\n                    item.style.transition = 'opacity ' + this._options.opacityTimingCSS + 's ease';\r\n                });\r\n            };\r\n\r\n            const fade = () => {\r\n                matched.forEach(item => {\r\n                    item.style.opacity = 1;\r\n                });\r\n\r\n                unmatched.forEach(item => {\r\n                    item.style.opacity = 0;\r\n                });\r\n            };\r\n\r\n            const clearFade = () => {\r\n                this._options.items.forEach(item => {\r\n                    item.style.transition = '';\r\n                    item.style.opacity = '';\r\n                });\r\n\r\n                matched.forEach(item => {\r\n                    item.style.display = '';\r\n                });\r\n\r\n                unmatched.forEach(item => {\r\n                    item.style.display = 'none';\r\n                });\r\n            };\r\n\r\n            const animation = this.animate(() => {\r\n                const fadeAfterAnimation = new Promise((resolve, reject) => {\r\n                    const onFadeEnd = () => {\r\n                        this.store(0);\r\n                        this.transform(0);\r\n                        resolve();\r\n                    };\r\n\r\n                    prepareFade();\r\n\r\n                    if (hiddenMatched.length) {\r\n                        hiddenMatched.forEach(item => {\r\n                            item.style.opacity = 0;\r\n                        });\r\n                    }\r\n\r\n                    requestAnimationFrame(() => {\r\n                        if (hiddenMatched.length) {\r\n                            hiddenMatched.forEach(item => {\r\n                                item.style.display = '';\r\n                            });\r\n                        }\r\n\r\n                        if (hiddenMatched.length && makeRoomBeforeFade) {\r\n                            requestAnimationFrame(() => onFadeEnd());\r\n                        } else if (!hiddenMatched.length || (hiddenMatched.length && !makeRoomBeforeFade)) {\r\n                            requestAnimationFrame(() => {\r\n                                fade();\r\n\r\n                                attachTimeout(\r\n                                    this._options.element,\r\n                                    () => {\r\n                                        clearFade();\r\n\r\n                                        requestAnimationFrame(() => onFadeEnd());\r\n                                    },\r\n                                    this.options.opacityTiming,\r\n                                    'opacity'\r\n                                );\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n\r\n                return fadeAfterAnimation;\r\n            });\r\n\r\n            animation.then(() => {\r\n                if (makeRoomBeforeFade) {\r\n                    prepareFade();\r\n\r\n                    requestAnimationFrame(() => {\r\n                        fade();\r\n\r\n                        clearTimeout(this._filterTimeout);\r\n\r\n                        this._filterTimeout = setTimeout(() => clearFade(), this.options.opacityTiming);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        destroy() {\r\n            // TODO: do it\r\n        }\r\n\r\n        refresh() {\r\n            // TODO: do it\r\n        }\r\n\r\n        // TODO: private\r\n        layout() {\r\n            if (this._options.masonry) {\r\n                const rowHeight = parseInt(window.getComputedStyle(this._options.element).getPropertyValue('grid-auto-rows'));\r\n                const rowGap = parseInt(window.getComputedStyle(this._options.element).getPropertyValue('grid-row-gap'));\r\n\r\n                this._options.items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                    const rowSpan = Math.ceil((item.querySelector('.content').getBoundingClientRect().height + rowGap) / (rowHeight + rowGap));\r\n                    item.style.gridRowEnd = 'span ' + rowSpan;\r\n                });\r\n            }\r\n        }\r\n\r\n        // TODO: private\r\n        clear() {\r\n            this._options.element.style.position = '';\r\n            this._options.element.style.width = '';\r\n            this._options.element.style.height = '';\r\n            this._options.element.style.transition = '';\r\n\r\n            this._options.items.forEach(item => {\r\n                item.style.transform = '';\r\n                item.style.transformOrigin = '';\r\n                item.style.position = '';\r\n                item.style.transition = '';\r\n                item.style.width = '';\r\n                item.style.height = '';\r\n                item.style.margin = '';\r\n            });\r\n        }\r\n\r\n        // TODO: private\r\n        store(id = 0) {\r\n            this._viewport.calcScrollTop();\r\n            this._viewport.calcScrollLeft();\r\n\r\n            const gridRect = this._options.element.getBoundingClientRect();\r\n            if (!('rect' in this._options.element)) {\r\n                this._options.element.rect = [];\r\n            }\r\n\r\n            this._options.element.rect[id] = {\r\n                width: gridRect.width,\r\n                height: gridRect.height,\r\n                top: gridRect.top + this._viewport.scrollTop,\r\n                left: gridRect.left + this._viewport.scrollLeft\r\n            };\r\n\r\n            this._options.items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                if (!('rect' in item)) {\r\n                    item.rect = [];\r\n                }\r\n\r\n                const itemRect = item.getBoundingClientRect();\r\n                item.rect[id] = {\r\n                    width: itemRect.width,\r\n                    height: itemRect.height,\r\n                    top: itemRect.top + this._viewport.scrollTop - this._options.element.rect[id].top,\r\n                    left: itemRect.left + this._viewport.scrollLeft - this._options.element.rect[id].left,\r\n                    scaleX: 1,\r\n                    scaleY: 1\r\n                };\r\n\r\n                item.rect[id].top = item.rect[id].top >= 0 ? item.rect[id].top : 0;\r\n                item.rect[id].left = item.rect[id].left >= 0 ? item.rect[id].left : 0;\r\n\r\n                if (id === 1) {\r\n                    const scaleX = item.rect[0].width / itemRect.width;\r\n                    const scaleY = item.rect[0].height / itemRect.height;\r\n\r\n                    if (scaleX > 0) {\r\n                        item.rect[id].scaleX = 1 / scaleX;\r\n                    }\r\n\r\n                    if (scaleY > 0) {\r\n                        item.rect[id].scaleY = 1 / scaleY;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // TODO: private\r\n        transform(id = 0) {\r\n            this._options.element.style.position = 'relative';\r\n            this._options.element.style.width = this._options.element.rect[id].width + 'px';\r\n            this._options.element.style.height = this._options.element.rect[id].height + 'px';\r\n\r\n            this._options.items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                let transform = 'translate3d(' + item.rect[id].left + 'px,' + item.rect[id].top + 'px, 0px)';\r\n\r\n                if (this.options.scaleXY) {\r\n                    transform += ' scale3d(' + item.rect[id].scaleX + ', ' + item.rect[id].scaleY + ', 1)';\r\n                }\r\n\r\n                if (!this.options.scaleXY || id === 0) {\r\n                    item.style.width = item.rect[id].width + 'px';\r\n                    item.style.height = item.rect[id].height + 'px';\r\n                }\r\n\r\n                item.style.margin = 0;\r\n                item.style.position = 'absolute';\r\n                item.style.transformOrigin = '0 0 0';\r\n                item.style.transform = transform;\r\n            });\r\n        }\r\n    }\n\n    return Griddie;\n\n})));\n"],"file":"griddie.min.js"}