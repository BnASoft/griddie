{"version":3,"sources":["griddie.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_typeof","Symbol","iterator","obj","constructor","_classCallCheck","instance","TypeError","_toConsumableArray","arr","Array","isArray","arr2","from","global","factory","exports","module","define","amd","Griddie","this","navigator","userAgent","toLowerCase","_polyfill","vendorsPrefixes","MutationObserver","window","getObserverId","el","document","createElement","transEndEventNames","WebkitTransition","MozTransition","OTransition","msTransition","transition","name","undefined","style","parent","prefix","concat","classList","join","id","disconnectObserver","mode","observerId","disconnect","clearElementTimer","element","autoDisconnectObserver","parentElement","attachTimeout","callback","time","e","removedNodes","some","observe","childList","setElementTimer","detachTimeout","stringContains","heystack","needle","String","includes","indexOf","Viewport","_window","_html","documentElement","_body","body","_frame1","_frame2","_prefix1","_prefix2","_offsetWidth","_offsetHeight","_width","_height","_scrollTop","_scrollLeft","_lock","calcAll","value","offsetWidth","offsetHeight","width","height","scrollTop","scrollLeft","calcOffsetWidth","calcOffsetHeight","calcWidth","calcHeight","calcScrollTop","calcScrollLeft","all","get","set","bool","top","left","scrollBarWidth","scrollBarHeight","position","Math","abs","parseFloat","scroll","behavior","privateEventsStorage","detachEventListener","CustomEvent","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","Event","events","startsWith","substr","eventNameWithNamespace","replace","type","split","removeEventListener","handler","attachEventListener","once","count","_handler","addEventListener","options","_this","_element","_items","children","_options","_viewport","layout","_this2","layoutChanges","Promise","resolve","reject","clearGridStyles","clearItemsStyles","storeGridData","storeItemsData","applyGridStyles","applyItemsStyles","requestAnimationFrame","transformTransition","transformTimingCSS","widthHeightTransition","filter","item","display","forEach","scaleXY","transformTiming","object","changes","then","_this3","_filter","matched","x","matches","unmatched","hiddenMatched","makeRoomBeforeFade","prepareFade","opacityTimingCSS","fade","opacity","clearFade","animate","onFadeEnd","opacityTiming","clearTimeout","_filterTimeout","setTimeout","gridRowEnd","rect","computed","getComputedStyle","getPropertyValue","masonry","gridTemplateColumns","rowHeight","gridAutoRows","parseInt","gridColumnGap","rowGap","gridRowGap","rowSpan","ceil","getBoundingClientRect","transform","margin","transformOrigin","gridRect","marginTop","marginLeft","_this4","itemRect","scaleX","scaleY","_this5"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Griddie', factory) :\n    (global.Griddie = factory());\n}(this, (function () { 'use strict';\n\n    const isPromise = object => !!object && (typeof object === 'object' || typeof object === 'function') && typeof object.then === 'function';\n\n    const userAgent = navigator.userAgent.toLowerCase();\r\n\r\n    const vendorsPrefixes = ['WebKit', 'Moz', 'O', 'Ms', ''];\r\n\r\n    const MutationObserver = (() => {\r\n        for (let i = 0; i < vendorsPrefixes.length; i++) {\r\n            if (vendorsPrefixes[i] + 'MutationObserver' in window) {\r\n                return window[vendorsPrefixes[i] + 'MutationObserver'];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    })();\r\n\r\n    const transitionEndEventName = (() => {\r\n        const el = document.createElement('div');\r\n\r\n        const transEndEventNames = {\r\n            WebkitTransition: 'webkitTransitionEnd',\r\n            MozTransition: 'transitionend',\r\n            OTransition: 'oTransitionEnd otransitionend',\r\n            msTransition: 'MSTransitionEnd',\r\n            transition: 'transitionend'\r\n        };\r\n\r\n        for (let name in transEndEventNames) {\r\n            if (el.style[name] !== undefined) {\r\n                return transEndEventNames[name];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    })();\n\n    const getObserverId = (parent, prefix) => prefix + [...parent.classList].join('') + parent.id + 'Observer';\r\n\r\n    const disconnectObserver = (parent, mode, id) => {\r\n        const observerId = getObserverId(parent, id + mode);\r\n        if (parent[observerId]) {\r\n            parent[observerId].disconnect();\r\n            delete parent[observerId];\r\n        }\r\n    };\r\n\r\n    const setElementTimer = (element, mode, callback, time, id) => {\r\n        clearElementTimer(element, mode, id);\r\n        element[id] = window['set' + mode](callback, time);\r\n\r\n        const parent = element.parentElement;\r\n        const observerId = getObserverId(parent, id + mode);\r\n        parent[observerId] = new MutationObserver(e => {\r\n            if ([...e[0].removedNodes].some(el => el === element)) {\r\n                clearElementTimer(element, mode, id);\r\n                disconnectObserver(parent, mode, id);\r\n            }\r\n        });\r\n        parent[observerId].observe(parent, { childList: true });\r\n    };\r\n\r\n    const clearElementTimer = (element, mode, id, autoDisconnectObserver = false) => {\r\n        window['clear' + mode](element[id]);\r\n        delete element[id];\r\n\r\n        const parent = element.parentElement;\r\n        if (autoDisconnectObserver) {\r\n            disconnectObserver(parent, mode, id);\r\n        }\r\n    };\r\n\r\n    const attachTimeout = (element, callback = () => {}, time = 0, id = 'niteTimeout') => setElementTimer(element, 'Timeout', callback, time, id);\r\n    const detachTimeout = (element, id = 'niteTimeout') => clearElementTimer(element, 'Timeout', id, true);\n\n    /**\r\n     * @param {string} prop\r\n     * @param {string} value\r\n     * @returns {boolean}\r\n     */\r\n\r\n    /**\r\n     * @param {string} heystack\r\n     * @param {string} needle\r\n     * @returns {boolean}\r\n     */\r\n    const stringContains = (heystack, needle) => {\r\n        return String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\r\n    };\r\n\r\n    /**\r\n     * @param {string} heystack\r\n     * @param {string} needle\r\n     * @returns {boolean}\r\n     */\r\n    const stringStartsWith = (heystack, needle) => {\r\n        return String.prototype.startsWith ? heystack.startsWith(needle) : heystack.substr(0, needle.length) === needle;\r\n    };\n\n    /**\r\n     *\r\n     */\r\n    class Viewport {\r\n        constructor() {\r\n            this._window = window;\r\n            this._html = document.documentElement;\r\n            this._body = document.body;\r\n\r\n            this._frame1 = this._window;\r\n            this._frame2 = this._html || this._body;\r\n            this._prefix1 = 'inner';\r\n            this._prefix2 = 'offset';\r\n            if (!this._prefix1 + 'Width' in this._frame1) {\r\n                this._prefix1 = 'client';\r\n                this._frame1 = this._frame2;\r\n            }\r\n\r\n            this._offsetWidth = 0;\r\n            this._offsetHeight = 0;\r\n            this._width = 0;\r\n            this._height = 0;\r\n            this._scrollTop = 0;\r\n            this._scrollLeft = 0;\r\n\r\n            this._lock = false;\r\n\r\n            this.calcAll();\r\n        }\r\n\r\n        get offsetWidth() {\r\n            return this._offsetWidth;\r\n        }\r\n        get offsetHeight() {\r\n            return this._offsetHeight;\r\n        }\r\n        get width() {\r\n            return this._width;\r\n        }\r\n        get height() {\r\n            return this._height;\r\n        }\r\n        get scrollTop() {\r\n            return this._scrollTop;\r\n        }\r\n        get scrollLeft() {\r\n            return this._scrollLeft;\r\n        }\r\n        get all() {\r\n            return {\r\n                offsetWidth: this.offsetWidth,\r\n                offsetHeight: this.offsetHeight,\r\n                width: this.width,\r\n                height: this.height,\r\n                scrollTop: this.scrollTop,\r\n                scrollLeft: this.scrollLeft\r\n            };\r\n        }\r\n\r\n        calcOffsetWidth() {\r\n            this._offsetWidth = this._body[this._prefix2 + 'Width'];\r\n            return this.offsetWidth;\r\n        }\r\n        calcOffsetHeight() {\r\n            this._offsetHeight = this._body[this._prefix2 + 'Height'];\r\n            return this.offsetHeight;\r\n        }\r\n        calcWidth() {\r\n            this._width = this._frame1[this._prefix1 + 'Width'];\r\n            return this.width;\r\n        }\r\n        calcHeight() {\r\n            this._height = this._frame1[this._prefix1 + 'Height'];\r\n            return this.height;\r\n        }\r\n        calcScrollTop() {\r\n            this._scrollTop = this._frame2.scrollTop || 0;\r\n            return this.scrollTop;\r\n        }\r\n        calcScrollLeft() {\r\n            this._scrollLeft = this._frame2.scrollLeft || 0;\r\n            return this.scrollLeft;\r\n        }\r\n        calcAll() {\r\n            this.calcOffsetWidth();\r\n            this.calcOffsetHeight();\r\n            this.calcWidth();\r\n            this.calcHeight();\r\n            this.calcScrollTop();\r\n            this.calcScrollLeft();\r\n            return this.all;\r\n        }\r\n\r\n        get lock() {\r\n            return this._lock;\r\n        }\r\n\r\n        set lock(bool) {\r\n            this._lock = bool;\r\n\r\n            if (this._lock) {\r\n                this._body.style.top = -this.calcScrollTop() + 'px';\r\n                this._body.style.left = -this.calcScrollLeft() + 'px';\r\n\r\n                let scrollBarWidth = this.calcOffsetWidth();\r\n                let scrollBarHeight = this.calcOffsetHeight();\r\n\r\n                this._html.style.top = '0px';\r\n                this._html.style.left = '0px';\r\n                this._html.style.position = 'fixed';\r\n                this._body.style.position = 'fixed';\r\n                this._html.style.width = '100%';\r\n                this._body.style.width = '100%';\r\n\r\n                let offsetWidth = this.calcOffsetWidth();\r\n                let offsetHeight = this.calcOffsetHeight();\r\n                scrollBarWidth = offsetWidth - scrollBarWidth;\r\n                scrollBarHeight = offsetHeight - scrollBarHeight;\r\n\r\n                this._body.style.width = offsetWidth - scrollBarWidth + 'px';\r\n                this._body.style.height = offsetHeight - scrollBarHeight + 'px';\r\n            } else {\r\n                let scrollTop = Math.abs(parseFloat(this._body.style.top));\r\n                let scrollLeft = Math.abs(parseFloat(this._body.style.left));\r\n\r\n                this._html.style.position = '';\r\n                this._html.style.top = '';\r\n                this._html.style.left = '';\r\n                this._html.style.width = '';\r\n                this._body.style.position = '';\r\n                this._body.style.top = '';\r\n                this._body.style.left = '';\r\n                this._body.style.width = '';\r\n\r\n                this._window.scroll({\r\n                    top: scrollTop,\r\n                    left: scrollLeft,\r\n                    behavior: 'instant'\r\n                });\r\n            }\r\n        }\r\n    }\n\n    const eventNamespaceParserSeparator = '__namespace__';\r\n    let privateEventsStorage = {};\r\n\r\n    const CustomEvent =\r\n        window.CustomEvent ||\r\n        (() => {\r\n            const _polyfill = (event, params) => {\r\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n                const evt = document.createEvent('CustomEvent');\r\n                evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n                return evt;\r\n            };\r\n            _polyfill.prototype = window.Event.prototype;\r\n            return _polyfill;\r\n        })();\r\n\r\n    /**\r\n     * @param {HTMLElement} element\r\n     * @param {string} events\r\n     * @returns {undefined}\r\n     */\r\n    const detachEventListener = (element, events) => {\r\n        if (!element || typeof events !== 'string') {\r\n            return;\r\n        }\r\n\r\n        if (stringStartsWith(events, '.')) {\r\n            for (let key in privateEventsStorage) {\r\n                const eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\r\n                if (stringContains(eventNameWithNamespace, events) && privateEventsStorage[key].element === element) {\r\n                    detachEventListener(element, eventNameWithNamespace);\r\n                }\r\n            }\r\n        } else {\r\n            events = events.split('.');\r\n\r\n            const type = events[0],\r\n                namespace = events[1];\r\n\r\n            if (namespace) {\r\n                events = events.join(eventNamespaceParserSeparator);\r\n            }\r\n\r\n            if (events in privateEventsStorage) {\r\n                element.removeEventListener(type, privateEventsStorage[events].handler);\r\n                delete privateEventsStorage[events];\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {HTMLElement} element\r\n     * @param {string} events\r\n     * @param {Function} handler\r\n     * @param {boolean} once\r\n     * @returns {undefined}\r\n     */\r\n    // TODO: Class EventListener .on .one .off .trigger jQuery-like...\r\n    const attachEventListener = (element, events, handler, once) => {\r\n        if (!element || typeof events !== 'string' || typeof handler !== 'function') {\r\n            return;\r\n        }\r\n\r\n        events = events.split('.');\r\n\r\n        const type = events[0];\r\n        const namespace = events[1];\r\n\r\n        if (namespace) {\r\n            events = events.join(eventNamespaceParserSeparator);\r\n        }\r\n\r\n        privateEventsStorage[events] = { element: element, count: 0, once: false };\r\n\r\n        if (true === once) {\r\n            let _handler = handler;\r\n            handler = function(event) {\r\n                if (events in privateEventsStorage) {\r\n                    privateEventsStorage[events].count++;\r\n                    if (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\r\n                        return;\r\n                    }\r\n                    _handler.call(this, event);\r\n                }\r\n                detachEventListener(element, events);\r\n            };\r\n        } else {\r\n            once = false;\r\n        }\r\n\r\n        privateEventsStorage[events] = {\r\n            ...privateEventsStorage[events],\r\n            ...{ handler: handler, once: once }\r\n        };\r\n\r\n        element.addEventListener(type, privateEventsStorage[events].handler, { once: once });\r\n    };\n\n    class Griddie {\r\n        constructor(element, options) {\r\n            this._element = element;\r\n            this._items = [...this._element.children];\r\n            this._options = {};\r\n            this._viewport = new Viewport();\r\n\r\n            this._element.instance = this;\r\n\r\n            this.options = options;\r\n            this.layout();\r\n            attachEventListener(window, 'resize.griddie', () => this.layout());\r\n        }\r\n\r\n        set options(options) {\r\n            this._options = {\r\n                ...{\r\n                    scaleXY: false, // TODO: single item exceptions ...\r\n                    opacityTiming: 300,\r\n                    transformTiming: 300,\r\n                    masonry: false\r\n                },\r\n                ...options\r\n            };\r\n            this._options.transformTimingCSS = this.options.transformTiming / 1000;\r\n            this._options.opacityTimingCSS = this.options.opacityTiming / 1000;\r\n        }\r\n\r\n        get options() {\r\n            return this._options;\r\n        }\r\n\r\n        animate(layoutChanges = () => {}) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            const animation = new Promise((resolve, reject) => {\r\n                const callback = () => {\r\n                    this.clearGridStyles();\r\n                    this.clearItemsStyles();\r\n                    this.layout();\r\n                    this.storeGridData(1);\r\n                    this.storeItemsData(1);\r\n                    this.applyGridStyles(0);\r\n                    this.applyItemsStyles(0);\r\n\r\n                    requestAnimationFrame(() => {\r\n                        const transformTransition = 'transform ' + this._options.transformTimingCSS + 's ease';\r\n                        const widthHeightTransition = 'width ' + this._options.transformTimingCSS + 's ease, height ' + this._options.transformTimingCSS + 's ease';\r\n\r\n                        this._element.style.transition = widthHeightTransition + ', ' + transformTransition;\r\n\r\n                        [...this._items].filter(item => item.style.display !== 'none').forEach(item => {\r\n                            let transition = transformTransition;\r\n                            if (!this.options.scaleXY) {\r\n                                transition += ', ' + widthHeightTransition;\r\n                            }\r\n                            item.style.transition = transition;\r\n                        });\r\n\r\n                        requestAnimationFrame(() => {\r\n                            this.applyGridStyles(1);\r\n                            this.applyItemsStyles(1);\r\n                        });\r\n\r\n                        attachTimeout(\r\n                            this._element,\r\n                            () => {\r\n                                this.clearGridStyles();\r\n                                this.clearItemsStyles();\r\n                                resolve();\r\n                            },\r\n                            this.options.transformTiming,\r\n                            'transform'\r\n                        );\r\n                    });\r\n                };\r\n\r\n                detachTimeout(this._element, 'transform');\r\n\r\n                this.clearGridStyles();\r\n                this.clearItemsStyles();\r\n                this.storeGridData(0);\r\n                this.storeItemsData(0);\r\n                this.applyGridStyles(0);\r\n                this.applyItemsStyles(0);\r\n\r\n                const changes = layoutChanges();\r\n\r\n                if (isPromise(changes)) {\r\n                    changes.then(() => callback());\r\n                } else {\r\n                    requestAnimationFrame(() => callback());\r\n                }\r\n            });\r\n\r\n            return animation;\r\n        }\r\n\r\n        filter(filter = '*') {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            const matched = this._items.filter(x => x.matches(filter));\r\n            const unmatched = this._items.filter(x => !x.matches(filter));\r\n            const hiddenMatched = matched.filter(x => x.style.display === 'none');\r\n            const makeRoomBeforeFade = matched.length !== hiddenMatched.length;\r\n\r\n            const prepareFade = () => {\r\n                this._items.forEach(item => {\r\n                    item.style.transition = 'opacity ' + this._options.opacityTimingCSS + 's ease';\r\n                });\r\n            };\r\n            const fade = () => {\r\n                matched.forEach(item => {\r\n                    item.style.opacity = 1;\r\n                });\r\n\r\n                unmatched.forEach(item => {\r\n                    item.style.opacity = 0;\r\n                });\r\n            };\r\n            const clearFade = () => {\r\n                this._items.forEach(item => {\r\n                    item.style.transition = '';\r\n                    item.style.opacity = '';\r\n                });\r\n\r\n                matched.forEach(item => {\r\n                    item.style.display = '';\r\n                });\r\n\r\n                unmatched.forEach(item => {\r\n                    item.style.display = 'none';\r\n                });\r\n            };\r\n\r\n            const animation = this.animate(() => {\r\n                detachTimeout(this._element, 'opacity');\r\n\r\n                const fadeAfterAnimation = new Promise((resolve, reject) => {\r\n                    const onFadeEnd = () => {\r\n                        //this.storeGridData(0);\r\n                        this.storeItemsData(0);\r\n                        this.applyGridStyles(0);\r\n                        this.applyItemsStyles(0);\r\n                        resolve();\r\n                    };\r\n\r\n                    prepareFade();\r\n\r\n                    if (hiddenMatched.length) {\r\n                        hiddenMatched.forEach(item => {\r\n                            item.style.opacity = 0;\r\n                        });\r\n                    }\r\n\r\n                    requestAnimationFrame(() => {\r\n                        if (hiddenMatched.length) {\r\n                            hiddenMatched.forEach(item => {\r\n                                item.style.display = '';\r\n                            });\r\n                        }\r\n\r\n                        if (hiddenMatched.length && makeRoomBeforeFade) {\r\n                            requestAnimationFrame(() => onFadeEnd());\r\n                        } else if (!hiddenMatched.length || (hiddenMatched.length && !makeRoomBeforeFade)) {\r\n                            requestAnimationFrame(() => {\r\n                                fade();\r\n\r\n                                attachTimeout(\r\n                                    this._element,\r\n                                    () => {\r\n                                        clearFade();\r\n\r\n                                        requestAnimationFrame(() => onFadeEnd());\r\n                                    },\r\n                                    this.options.opacityTiming,\r\n                                    'opacity'\r\n                                );\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n\r\n                return fadeAfterAnimation;\r\n            });\r\n\r\n            animation.then(() => {\r\n                if (makeRoomBeforeFade) {\r\n                    prepareFade();\r\n\r\n                    requestAnimationFrame(() => {\r\n                        fade();\r\n\r\n                        clearTimeout(this._filterTimeout);\r\n\r\n                        this._filterTimeout = setTimeout(() => clearFade(), this.options.opacityTiming);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        destroy() {\r\n            this.clearGridStyles();\r\n            this.clearItemsStyles();\r\n            this._items.forEach(item => {\r\n                item.style.gridRowEnd = ''; // TODO: possibly in clear methods?\r\n                item.style.display = ''; // TODO: possibly in clear methods?\r\n                delete item.rect;\r\n            });\r\n            delete this._element.rect;\r\n            detachTimeout(this._element, 'transform');\r\n            detachTimeout(this._element, 'opacity');\r\n            detachEventListener(window, 'resize.griddie');\r\n            delete this._element.instance;\r\n        }\r\n\r\n        refresh() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n            // TODO: do it\r\n        }\r\n\r\n        // TODO: private\r\n        layout() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._element.style.position = 'relative';\r\n\r\n            const computed = window.getComputedStyle(this._element);\r\n            const display = computed.getPropertyValue('display');\r\n\r\n            if (this._options.masonry) {\r\n                if (computed.getPropertyValue('grid-template-columns') === 'none') {\r\n                    this._element.style.gridTemplateColumns = 'repeat(auto-fill, minmax(250px, 1fr))';\r\n                }\r\n\r\n                if (display !== 'grid') {\r\n                    this._element.style.display = 'grid';\r\n                }\r\n\r\n                let rowHeight = computed.getPropertyValue('grid-auto-rows');\r\n                if (rowHeight === 'auto') {\r\n                    rowHeight = this._element.style.gridAutoRows = '20px';\r\n                }\r\n                rowHeight = parseInt(rowHeight);\r\n\r\n                if (computed.getPropertyValue('grid-column-gap') === 'normal') {\r\n                    this._element.style.gridColumnGap = '0px';\r\n                }\r\n\r\n                let rowGap = computed.getPropertyValue('grid-row-gap');\r\n                if (rowGap === 'normal') {\r\n                    rowGap = this._element.style.gridRowGap = '0px';\r\n                }\r\n                rowGap = parseInt(rowGap);\r\n\r\n                this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                    const rowSpan = Math.ceil(([...item.children][0].getBoundingClientRect().height + rowGap) / (rowHeight + rowGap));\r\n                    item.style.gridRowEnd = 'span ' + rowSpan;\r\n                });\r\n            } else {\r\n                this._element.style.display = '';\r\n                this._element.style.gridTemplateColumns = '';\r\n                this._element.style.gridAutoRows = '';\r\n                this._element.style.gridColumnGap = '';\r\n                this._element.style.gridRowGap = '';\r\n                this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                    item.style.gridRowEnd = '';\r\n                });\r\n            }\r\n        }\r\n\r\n        // TODO: private\r\n        clearGridStyles() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._element.style.position = 'relative'; // ooooverkill\r\n            this._element.style.transform = '';\r\n            this._element.style.width = '';\r\n            this._element.style.height = '';\r\n            this._element.style.transition = '';\r\n            this._element.style.margin = '';\r\n        }\r\n\r\n        // TODO: private\r\n        clearItemsStyles() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._items.forEach(item => {\r\n                item.style.transform = '';\r\n                item.style.transformOrigin = '';\r\n                item.style.position = '';\r\n                item.style.transition = '';\r\n                item.style.width = '';\r\n                item.style.height = '';\r\n                item.style.margin = '';\r\n            });\r\n        }\r\n\r\n        // TODO: private\r\n        storeGridData(id = 0) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._viewport.calcScrollTop(); // TODO: optimize\r\n            this._viewport.calcScrollLeft(); // TODO: optimize\r\n\r\n            const gridRect = this._element.getBoundingClientRect();\r\n            const computed = window.getComputedStyle(this._element);\r\n            if (!('rect' in this._element)) {\r\n                this._element.rect = [];\r\n            }\r\n\r\n            this._element.rect[id] = {\r\n                width: gridRect.width,\r\n                height: gridRect.height,\r\n                top: gridRect.top + this._viewport.scrollTop,\r\n                left: gridRect.left + this._viewport.scrollLeft,\r\n                marginTop: parseInt(computed.getPropertyValue('margin-top')),\r\n                marginLeft: parseInt(computed.getPropertyValue('margin-left'))\r\n            };\r\n        }\r\n\r\n        // TODO: private\r\n        storeItemsData(id = 0) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._viewport.calcScrollTop(); // TODO: optimize\r\n            this._viewport.calcScrollLeft(); // TODO: optimize\r\n\r\n            this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                if (!('rect' in item)) {\r\n                    item.rect = [];\r\n                }\r\n\r\n                const itemRect = item.getBoundingClientRect();\r\n                item.rect[id] = {\r\n                    width: itemRect.width,\r\n                    height: itemRect.height,\r\n                    top: itemRect.top + this._viewport.scrollTop - this._element.rect[id].top,\r\n                    left: itemRect.left + this._viewport.scrollLeft - this._element.rect[id].left,\r\n                    scaleX: 1,\r\n                    scaleY: 1\r\n                };\r\n\r\n                item.rect[id].top = item.rect[id].top >= 0 ? item.rect[id].top : 0;\r\n                item.rect[id].left = item.rect[id].left >= 0 ? item.rect[id].left : 0;\r\n\r\n                if (id === 1) {\r\n                    const scaleX = item.rect[0].width / itemRect.width;\r\n                    const scaleY = item.rect[0].height / itemRect.height;\r\n\r\n                    if (scaleX > 0) {\r\n                        item.rect[id].scaleX = 1 / scaleX;\r\n                    }\r\n\r\n                    if (scaleY > 0) {\r\n                        item.rect[id].scaleY = 1 / scaleY;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // TODO: private\r\n        applyGridStyles(id = 0) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._element.style.margin = 0;\r\n            this._element.style.position = 'relative'; // overkill\r\n            this._element.style.transformOrigin = '0 0 0';\r\n            this._element.style.transform = 'translate3d(' + this._element.rect[id].marginLeft + 'px,' + this._element.rect[id].marginTop + 'px, 0px)';\r\n            this._element.style.width = this._element.rect[id].width + 'px';\r\n            this._element.style.height = this._element.rect[id].height + 'px';\r\n        }\r\n\r\n        // TODO: private\r\n        applyItemsStyles(id = 0) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                let transform = 'translate3d(' + item.rect[id].left + 'px,' + item.rect[id].top + 'px, 0px)';\r\n\r\n                if (this.options.scaleXY) {\r\n                    transform += ' scale3d(' + item.rect[id].scaleX + ', ' + item.rect[id].scaleY + ', 1)';\r\n                }\r\n\r\n                if (!this.options.scaleXY || id === 0) {\r\n                    item.style.width = item.rect[id].width + 'px';\r\n                    item.style.height = item.rect[id].height + 'px';\r\n                }\r\n\r\n                item.style.margin = 0;\r\n                item.style.position = 'absolute';\r\n                item.style.transformOrigin = '0 0 0';\r\n                item.style.transform = transform;\r\n            });\r\n        }\r\n    }\n\n    return Griddie;\n\n})));\n"],"file":"griddie.min.js"}