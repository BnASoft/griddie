{"version":3,"sources":["griddie.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_typeof","Symbol","iterator","obj","constructor","_classCallCheck","instance","TypeError","_toConsumableArray","arr","Array","isArray","arr2","from","global","factory","exports","module","define","amd","Griddie","this","navigator","userAgent","toLowerCase","_polyfill","vendorsPrefixes","MutationObserver","window","getObserverId","el","document","createElement","transEndEventNames","WebkitTransition","MozTransition","OTransition","msTransition","transition","name","undefined","style","parent","prefix","concat","classList","join","id","disconnectObserver","mode","observerId","disconnect","clearElementTimer","element","autoDisconnectObserver","parentElement","attachTimeout","callback","time","e","removedNodes","some","observe","childList","setElementTimer","detachTimeout","stringContains","heystack","needle","String","includes","indexOf","Viewport","_window","_html","documentElement","_body","body","_frame1","_frame2","_prefix1","_prefix2","_offsetWidth","_offsetHeight","_width","_height","_scrollTop","_scrollLeft","_lock","calcAll","value","offsetWidth","offsetHeight","width","height","scrollTop","scrollLeft","calcOffsetWidth","calcOffsetHeight","calcWidth","calcHeight","calcScrollTop","calcScrollLeft","all","get","set","bool","top","left","scrollBarWidth","scrollBarHeight","position","Math","abs","parseFloat","scroll","behavior","privateEventsStorage","detachEventListener","CustomEvent","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","Event","events","startsWith","substr","eventNameWithNamespace","replace","type","split","removeEventListener","handler","attachEventListener","once","count","_handler","addEventListener","options","_this","_element","_items","children","_options","_viewport","layout","_this2","layoutChanges","Promise","resolve","reject","clear","store","transform","requestAnimationFrame","transformTimingCSS","filter","item","display","forEach","scaleXY","transformTiming","object","changes","then","_this3","_filter","matched","x","matches","unmatched","hiddenMatched","makeRoomBeforeFade","prepareFade","opacityTimingCSS","fade","opacity","clearFade","animate","onFadeEnd","opacityTiming","clearTimeout","_filterTimeout","setTimeout","gridRowEnd","rect","masonry","rowHeight","parseInt","getComputedStyle","getPropertyValue","rowGap","rowSpan","ceil","getBoundingClientRect","transformOrigin","margin","_this4","gridRect","itemRect","scaleX","scaleY","_this5"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Griddie', factory) :\n    (global.Griddie = factory());\n}(this, (function () { 'use strict';\n\n    const isPromise = object => !!object && (typeof object === 'object' || typeof object === 'function') && typeof object.then === 'function';\n\n    const userAgent = navigator.userAgent.toLowerCase();\r\n\r\n    const vendorsPrefixes = ['WebKit', 'Moz', 'O', 'Ms', ''];\r\n\r\n    const MutationObserver = (() => {\r\n        for (let i = 0; i < vendorsPrefixes.length; i++) {\r\n            if (vendorsPrefixes[i] + 'MutationObserver' in window) {\r\n                return window[vendorsPrefixes[i] + 'MutationObserver'];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    })();\r\n\r\n    const transitionEndEventName = (() => {\r\n        const el = document.createElement('div');\r\n\r\n        const transEndEventNames = {\r\n            WebkitTransition: 'webkitTransitionEnd',\r\n            MozTransition: 'transitionend',\r\n            OTransition: 'oTransitionEnd otransitionend',\r\n            msTransition: 'MSTransitionEnd',\r\n            transition: 'transitionend'\r\n        };\r\n\r\n        for (let name in transEndEventNames) {\r\n            if (el.style[name] !== undefined) {\r\n                return transEndEventNames[name];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    })();\n\n    const getObserverId = (parent, prefix) => prefix + [...parent.classList].join('') + parent.id + 'Observer';\r\n\r\n    const disconnectObserver = (parent, mode, id) => {\r\n        const observerId = getObserverId(parent, id + mode);\r\n        if (parent[observerId]) {\r\n            parent[observerId].disconnect();\r\n            delete parent[observerId];\r\n        }\r\n    };\r\n\r\n    const setElementTimer = (element, mode, callback, time, id) => {\r\n        clearElementTimer(element, mode, id);\r\n        element[id] = window['set' + mode](callback, time);\r\n\r\n        const parent = element.parentElement;\r\n        const observerId = getObserverId(parent, id + mode);\r\n        parent[observerId] = new MutationObserver(e => {\r\n            if ([...e[0].removedNodes].some(el => el === element)) {\r\n                clearElementTimer(element, mode, id);\r\n                disconnectObserver(parent, mode, id);\r\n            }\r\n        });\r\n        parent[observerId].observe(parent, { childList: true });\r\n    };\r\n\r\n    const clearElementTimer = (element, mode, id, autoDisconnectObserver = false) => {\r\n        window['clear' + mode](element[id]);\r\n        delete element[id];\r\n\r\n        const parent = element.parentElement;\r\n        if (autoDisconnectObserver) {\r\n            disconnectObserver(parent, mode, id);\r\n        }\r\n    };\r\n\r\n    const attachTimeout = (element, callback = () => {}, time = 0, id = 'niteTimeout') => setElementTimer(element, 'Timeout', callback, time, id);\r\n    const detachTimeout = (element, id = 'niteTimeout') => clearElementTimer(element, 'Timeout', id, true);\n\n    /**\r\n     * @param {string} prop\r\n     * @param {string} value\r\n     * @returns {boolean}\r\n     */\r\n\r\n    /**\r\n     * @param {string} heystack\r\n     * @param {string} needle\r\n     * @returns {boolean}\r\n     */\r\n    const stringContains = (heystack, needle) => {\r\n        return String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\r\n    };\r\n\r\n    /**\r\n     * @param {string} heystack\r\n     * @param {string} needle\r\n     * @returns {boolean}\r\n     */\r\n    const stringStartsWith = (heystack, needle) => {\r\n        return String.prototype.startsWith ? heystack.startsWith(needle) : heystack.substr(0, needle.length) === needle;\r\n    };\n\n    /**\r\n     *\r\n     */\r\n    class Viewport {\r\n        constructor() {\r\n            this._window = window;\r\n            this._html = document.documentElement;\r\n            this._body = document.body;\r\n\r\n            this._frame1 = this._window;\r\n            this._frame2 = this._html || this._body;\r\n            this._prefix1 = 'inner';\r\n            this._prefix2 = 'offset';\r\n            if (!this._prefix1 + 'Width' in this._frame1) {\r\n                this._prefix1 = 'client';\r\n                this._frame1 = this._frame2;\r\n            }\r\n\r\n            this._offsetWidth = 0;\r\n            this._offsetHeight = 0;\r\n            this._width = 0;\r\n            this._height = 0;\r\n            this._scrollTop = 0;\r\n            this._scrollLeft = 0;\r\n\r\n            this._lock = false;\r\n\r\n            this.calcAll();\r\n        }\r\n\r\n        get offsetWidth() {\r\n            return this._offsetWidth;\r\n        }\r\n        get offsetHeight() {\r\n            return this._offsetHeight;\r\n        }\r\n        get width() {\r\n            return this._width;\r\n        }\r\n        get height() {\r\n            return this._height;\r\n        }\r\n        get scrollTop() {\r\n            return this._scrollTop;\r\n        }\r\n        get scrollLeft() {\r\n            return this._scrollLeft;\r\n        }\r\n        get all() {\r\n            return {\r\n                offsetWidth: this.offsetWidth,\r\n                offsetHeight: this.offsetHeight,\r\n                width: this.width,\r\n                height: this.height,\r\n                scrollTop: this.scrollTop,\r\n                scrollLeft: this.scrollLeft\r\n            };\r\n        }\r\n\r\n        calcOffsetWidth() {\r\n            this._offsetWidth = this._body[this._prefix2 + 'Width'];\r\n            return this.offsetWidth;\r\n        }\r\n        calcOffsetHeight() {\r\n            this._offsetHeight = this._body[this._prefix2 + 'Height'];\r\n            return this.offsetHeight;\r\n        }\r\n        calcWidth() {\r\n            this._width = this._frame1[this._prefix1 + 'Width'];\r\n            return this.width;\r\n        }\r\n        calcHeight() {\r\n            this._height = this._frame1[this._prefix1 + 'Height'];\r\n            return this.height;\r\n        }\r\n        calcScrollTop() {\r\n            this._scrollTop = this._frame2.scrollTop || 0;\r\n            return this.scrollTop;\r\n        }\r\n        calcScrollLeft() {\r\n            this._scrollLeft = this._frame2.scrollLeft || 0;\r\n            return this.scrollLeft;\r\n        }\r\n        calcAll() {\r\n            this.calcOffsetWidth();\r\n            this.calcOffsetHeight();\r\n            this.calcWidth();\r\n            this.calcHeight();\r\n            this.calcScrollTop();\r\n            this.calcScrollLeft();\r\n            return this.all;\r\n        }\r\n\r\n        get lock() {\r\n            return this._lock;\r\n        }\r\n\r\n        set lock(bool) {\r\n            this._lock = bool;\r\n\r\n            if (this._lock) {\r\n                this._body.style.top = -this.calcScrollTop() + 'px';\r\n                this._body.style.left = -this.calcScrollLeft() + 'px';\r\n\r\n                let scrollBarWidth = this.calcOffsetWidth();\r\n                let scrollBarHeight = this.calcOffsetHeight();\r\n\r\n                this._html.style.top = '0px';\r\n                this._html.style.left = '0px';\r\n                this._html.style.position = 'fixed';\r\n                this._body.style.position = 'fixed';\r\n                this._html.style.width = '100%';\r\n                this._body.style.width = '100%';\r\n\r\n                let offsetWidth = this.calcOffsetWidth();\r\n                let offsetHeight = this.calcOffsetHeight();\r\n                scrollBarWidth = offsetWidth - scrollBarWidth;\r\n                scrollBarHeight = offsetHeight - scrollBarHeight;\r\n\r\n                this._body.style.width = offsetWidth - scrollBarWidth + 'px';\r\n                this._body.style.height = offsetHeight - scrollBarHeight + 'px';\r\n            } else {\r\n                let scrollTop = Math.abs(parseFloat(this._body.style.top));\r\n                let scrollLeft = Math.abs(parseFloat(this._body.style.left));\r\n\r\n                this._html.style.position = '';\r\n                this._html.style.top = '';\r\n                this._html.style.left = '';\r\n                this._html.style.width = '';\r\n                this._body.style.position = '';\r\n                this._body.style.top = '';\r\n                this._body.style.left = '';\r\n                this._body.style.width = '';\r\n\r\n                this._window.scroll({\r\n                    top: scrollTop,\r\n                    left: scrollLeft,\r\n                    behavior: 'instant'\r\n                });\r\n            }\r\n        }\r\n    }\n\n    const eventNamespaceParserSeparator = '__namespace__';\r\n    let privateEventsStorage = {};\r\n\r\n    const CustomEvent =\r\n        window.CustomEvent ||\r\n        (() => {\r\n            const _polyfill = (event, params) => {\r\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n                const evt = document.createEvent('CustomEvent');\r\n                evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n                return evt;\r\n            };\r\n            _polyfill.prototype = window.Event.prototype;\r\n            return _polyfill;\r\n        })();\r\n\r\n    /**\r\n     * @param {HTMLElement} element\r\n     * @param {string} events\r\n     * @returns {undefined}\r\n     */\r\n    const detachEventListener = (element, events) => {\r\n        if (!element || typeof events !== 'string') {\r\n            return;\r\n        }\r\n\r\n        if (stringStartsWith(events, '.')) {\r\n            for (let key in privateEventsStorage) {\r\n                const eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\r\n                if (stringContains(eventNameWithNamespace, events) && privateEventsStorage[key].element === element) {\r\n                    detachEventListener(element, eventNameWithNamespace);\r\n                }\r\n            }\r\n        } else {\r\n            events = events.split('.');\r\n\r\n            const type = events[0],\r\n                namespace = events[1];\r\n\r\n            if (namespace) {\r\n                events = events.join(eventNamespaceParserSeparator);\r\n            }\r\n\r\n            if (events in privateEventsStorage) {\r\n                element.removeEventListener(type, privateEventsStorage[events].handler);\r\n                delete privateEventsStorage[events];\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {HTMLElement} element\r\n     * @param {string} events\r\n     * @param {Function} handler\r\n     * @param {boolean} once\r\n     * @returns {undefined}\r\n     */\r\n    // TODO: Class EventListener .on .one .off .trigger jQuery-like...\r\n    const attachEventListener = (element, events, handler, once) => {\r\n        if (!element || typeof events !== 'string' || typeof handler !== 'function') {\r\n            return;\r\n        }\r\n\r\n        events = events.split('.');\r\n\r\n        const type = events[0];\r\n        const namespace = events[1];\r\n\r\n        if (namespace) {\r\n            events = events.join(eventNamespaceParserSeparator);\r\n        }\r\n\r\n        privateEventsStorage[events] = { element: element, count: 0, once: false };\r\n\r\n        if (true === once) {\r\n            let _handler = handler;\r\n            handler = function(event) {\r\n                if (events in privateEventsStorage) {\r\n                    privateEventsStorage[events].count++;\r\n                    if (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\r\n                        return;\r\n                    }\r\n                    _handler.call(this, event);\r\n                }\r\n                detachEventListener(element, events);\r\n            };\r\n        } else {\r\n            once = false;\r\n        }\r\n\r\n        privateEventsStorage[events] = {\r\n            ...privateEventsStorage[events],\r\n            ...{ handler: handler, once: once }\r\n        };\r\n\r\n        element.addEventListener(type, privateEventsStorage[events].handler, { once: once });\r\n    };\n\n    class Griddie {\r\n        constructor(element, options) {\r\n            this._element = element;\r\n            this._items = [...this._element.children];\r\n            this._options = {};\r\n            this._viewport = new Viewport();\r\n\r\n            this._element.instance = this;\r\n\r\n            this.options = options;\r\n            this.layout();\r\n            attachEventListener(window, 'resize.griddie', () => this.layout());\r\n        }\r\n\r\n        set options(options) {\r\n            this._options = {\r\n                ...{\r\n                    scaleXY: false, // TODO: single item exceptions ...\r\n                    opacityTiming: 300,\r\n                    transformTiming: 300,\r\n                    masonry: false\r\n                },\r\n                ...options\r\n            };\r\n            this._options.transformTimingCSS = this.options.transformTiming / 1000;\r\n            this._options.opacityTimingCSS = this.options.opacityTiming / 1000;\r\n        }\r\n\r\n        get options() {\r\n            return this._options;\r\n        }\r\n\r\n        animate(layoutChanges = () => {}) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            const animation = new Promise((resolve, reject) => {\r\n                const callback = () => {\r\n                    this.clear();\r\n                    this.layout(0);\r\n                    this.store(1);\r\n                    this.transform(0);\r\n\r\n                    requestAnimationFrame(() => {\r\n                        this._element.style.transition = 'height ' + this._options.transformTimingCSS + 's ease';\r\n\r\n                        [...this._items].filter(item => item.style.display !== 'none').forEach(item => {\r\n                            let transition = 'transform ' + this._options.transformTimingCSS + 's ease';\r\n                            if (!this.options.scaleXY) {\r\n                                transition += ', width ' + this._options.transformTimingCSS + 's ease, height ' + this._options.transformTimingCSS + 's ease';\r\n                            }\r\n\r\n                            item.style.transition = transition;\r\n                        });\r\n\r\n                        requestAnimationFrame(() => this.transform(1));\r\n\r\n                        attachTimeout(\r\n                            this._element,\r\n                            () => {\r\n                                this.clear();\r\n                                resolve();\r\n                            },\r\n                            this.options.transformTiming,\r\n                            'transform'\r\n                        );\r\n                    });\r\n                };\r\n\r\n                detachTimeout(this._element, 'transform');\r\n\r\n                this.clear();\r\n                this.store(0);\r\n                this.transform(0);\r\n\r\n                const changes = layoutChanges();\r\n\r\n                if (isPromise(changes)) {\r\n                    changes.then(() => callback());\r\n                } else {\r\n                    callback();\r\n                }\r\n            });\r\n\r\n            return animation;\r\n        }\r\n\r\n        filter(filter = '*') {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            const matched = this._items.filter(x => x.matches(filter));\r\n            const unmatched = this._items.filter(x => !x.matches(filter));\r\n            const hiddenMatched = matched.filter(x => x.style.display === 'none');\r\n            const makeRoomBeforeFade = matched.length !== hiddenMatched.length;\r\n\r\n            const prepareFade = () => {\r\n                this._items.forEach(item => {\r\n                    item.style.transition = 'opacity ' + this._options.opacityTimingCSS + 's ease';\r\n                });\r\n            };\r\n            const fade = () => {\r\n                matched.forEach(item => {\r\n                    item.style.opacity = 1;\r\n                });\r\n\r\n                unmatched.forEach(item => {\r\n                    item.style.opacity = 0;\r\n                });\r\n            };\r\n            const clearFade = () => {\r\n                this._items.forEach(item => {\r\n                    item.style.transition = '';\r\n                    item.style.opacity = '';\r\n                });\r\n\r\n                matched.forEach(item => {\r\n                    item.style.display = '';\r\n                });\r\n\r\n                unmatched.forEach(item => {\r\n                    item.style.display = 'none';\r\n                });\r\n            };\r\n\r\n            const animation = this.animate(() => {\r\n                detachTimeout(this._element, 'opacity');\r\n\r\n                const fadeAfterAnimation = new Promise((resolve, reject) => {\r\n                    const onFadeEnd = () => {\r\n                        this.store(0);\r\n                        this.transform(0);\r\n                        resolve();\r\n                    };\r\n\r\n                    prepareFade();\r\n\r\n                    if (hiddenMatched.length) {\r\n                        hiddenMatched.forEach(item => {\r\n                            item.style.opacity = 0;\r\n                        });\r\n                    }\r\n\r\n                    requestAnimationFrame(() => {\r\n                        if (hiddenMatched.length) {\r\n                            hiddenMatched.forEach(item => {\r\n                                item.style.display = '';\r\n                            });\r\n                        }\r\n\r\n                        if (hiddenMatched.length && makeRoomBeforeFade) {\r\n                            requestAnimationFrame(() => onFadeEnd());\r\n                        } else if (!hiddenMatched.length || (hiddenMatched.length && !makeRoomBeforeFade)) {\r\n                            requestAnimationFrame(() => {\r\n                                fade();\r\n\r\n                                attachTimeout(\r\n                                    this._element,\r\n                                    () => {\r\n                                        clearFade();\r\n\r\n                                        requestAnimationFrame(() => onFadeEnd());\r\n                                    },\r\n                                    this.options.opacityTiming,\r\n                                    'opacity'\r\n                                );\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n\r\n                return fadeAfterAnimation;\r\n            });\r\n\r\n            animation.then(() => {\r\n                if (makeRoomBeforeFade) {\r\n                    prepareFade();\r\n\r\n                    requestAnimationFrame(() => {\r\n                        fade();\r\n\r\n                        clearTimeout(this._filterTimeout);\r\n\r\n                        this._filterTimeout = setTimeout(() => clearFade(), this.options.opacityTiming);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        destroy() {\r\n            this.clear();\r\n            this._items.forEach(item => {\r\n                item.style.gridRowEnd = ''; // TODO: possibly in clear()?\r\n                item.style.display = ''; // TODO: possibly in clear()?\r\n                delete item.rect;\r\n            });\r\n            delete this._element.rect;\r\n            detachTimeout(this._element, 'transform');\r\n            detachTimeout(this._element, 'opacity');\r\n            detachEventListener(window, 'resize.griddie');\r\n            delete this._element.instance;\r\n        }\r\n\r\n        refresh() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n            // TODO: do it\r\n        }\r\n\r\n        // TODO: private\r\n        layout() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            if (this._options.masonry) {\r\n                const rowHeight = parseInt(window.getComputedStyle(this._element).getPropertyValue('grid-auto-rows'));\r\n                const rowGap = parseInt(window.getComputedStyle(this._element).getPropertyValue('grid-row-gap'));\r\n\r\n                this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                    const rowSpan = Math.ceil(([...item.children][0].getBoundingClientRect().height + rowGap) / (rowHeight + rowGap));\r\n                    item.style.gridRowEnd = 'span ' + rowSpan;\r\n                });\r\n            }\r\n        }\r\n\r\n        // TODO: private\r\n        clear() {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._element.style.position = '';\r\n            this._element.style.width = '';\r\n            this._element.style.height = '';\r\n            this._element.style.transition = '';\r\n\r\n            this._items.forEach(item => {\r\n                item.style.transform = '';\r\n                item.style.transformOrigin = '';\r\n                item.style.position = '';\r\n                item.style.transition = '';\r\n                item.style.width = '';\r\n                item.style.height = '';\r\n                item.style.margin = '';\r\n            });\r\n        }\r\n\r\n        // TODO: private\r\n        store(id = 0) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._viewport.calcScrollTop();\r\n            this._viewport.calcScrollLeft();\r\n\r\n            const gridRect = this._element.getBoundingClientRect();\r\n            if (!('rect' in this._element)) {\r\n                this._element.rect = [];\r\n            }\r\n\r\n            this._element.rect[id] = {\r\n                width: gridRect.width,\r\n                height: gridRect.height,\r\n                top: gridRect.top + this._viewport.scrollTop,\r\n                left: gridRect.left + this._viewport.scrollLeft\r\n            };\r\n\r\n            this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                if (!('rect' in item)) {\r\n                    item.rect = [];\r\n                }\r\n\r\n                const itemRect = item.getBoundingClientRect();\r\n                item.rect[id] = {\r\n                    width: itemRect.width,\r\n                    height: itemRect.height,\r\n                    top: itemRect.top + this._viewport.scrollTop - this._element.rect[id].top,\r\n                    left: itemRect.left + this._viewport.scrollLeft - this._element.rect[id].left,\r\n                    scaleX: 1,\r\n                    scaleY: 1\r\n                };\r\n\r\n                item.rect[id].top = item.rect[id].top >= 0 ? item.rect[id].top : 0;\r\n                item.rect[id].left = item.rect[id].left >= 0 ? item.rect[id].left : 0;\r\n\r\n                if (id === 1) {\r\n                    const scaleX = item.rect[0].width / itemRect.width;\r\n                    const scaleY = item.rect[0].height / itemRect.height;\r\n\r\n                    if (scaleX > 0) {\r\n                        item.rect[id].scaleX = 1 / scaleX;\r\n                    }\r\n\r\n                    if (scaleY > 0) {\r\n                        item.rect[id].scaleY = 1 / scaleY;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // TODO: private\r\n        transform(id = 0) {\r\n            if (!('instance' in this._element)) {\r\n                return;\r\n            }\r\n\r\n            this._element.style.position = 'relative';\r\n            this._element.style.width = this._element.rect[id].width + 'px';\r\n            this._element.style.height = this._element.rect[id].height + 'px';\r\n\r\n            this._items.filter(item => item.style.display !== 'none').forEach(item => {\r\n                let transform = 'translate3d(' + item.rect[id].left + 'px,' + item.rect[id].top + 'px, 0px)';\r\n\r\n                if (this.options.scaleXY) {\r\n                    transform += ' scale3d(' + item.rect[id].scaleX + ', ' + item.rect[id].scaleY + ', 1)';\r\n                }\r\n\r\n                if (!this.options.scaleXY || id === 0) {\r\n                    item.style.width = item.rect[id].width + 'px';\r\n                    item.style.height = item.rect[id].height + 'px';\r\n                }\r\n\r\n                item.style.margin = 0;\r\n                item.style.position = 'absolute';\r\n                item.style.transformOrigin = '0 0 0';\r\n                item.style.transform = transform;\r\n            });\r\n        }\r\n    }\n\n    return Griddie;\n\n})));\n"],"file":"griddie.min.js"}